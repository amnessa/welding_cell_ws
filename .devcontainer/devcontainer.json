{
    "name": "Isaac Sim UR5e Digital Twin",
    "image": "nvcr.io/nvidia/isaac-sim:5.1.0",

    // GPU and display forwarding for Isaac Sim GUI
    "runArgs": [
        "--network=host",
        "--privileged",
        "--gpus=all",
        "--volume=/tmp/.X11-unix:/tmp/.X11-unix:rw",
        "--volume=${localEnv:HOME}/.Xauthority:/isaac-sim/.Xauthority:rw",
        "--volume=${localEnv:HOME}/docker/isaac-sim/cache/main:/isaac-sim/.cache:rw",
        "--volume=${localEnv:HOME}/docker/isaac-sim/cache/computecache:/isaac-sim/.nv/ComputeCache:rw",
        "--volume=${localEnv:HOME}/docker/isaac-sim/logs:/isaac-sim/.nvidia-omniverse/logs:rw",
        "--volume=${localEnv:HOME}/docker/isaac-sim/config:/isaac-sim/.nvidia-omniverse/config:rw",
        "--volume=${localEnv:HOME}/docker/isaac-sim/data:/isaac-sim/.local/share/ov/data:rw",
        "--volume=${localEnv:HOME}/docker/isaac-sim/pkg:/isaac-sim/.local/share/ov/pkg:rw",
        "--volume=/usr/share/glvnd/egl_vendor.d:/usr/share/glvnd/egl_vendor.d:ro"
    ],

    // Environment variables for Isaac Sim and display
    "containerEnv": {
        "DISPLAY": "${localEnv:DISPLAY}",
        "ACCEPT_EULA": "Y",
        "PRIVACY_CONSENT": "Y",
        "NVIDIA_VISIBLE_DEVICES": "all",
        "NVIDIA_DRIVER_CAPABILITIES": "graphics,utility,compute,display",
        "QT_X11_NO_MITSHM": "1",
        "ROS_DOMAIN_ID": "0",
        "UR5E_ROBOT_IP": "192.168.8.4"
    },

    // Run as root for package installation (Isaac Sim default user is 1234)
    "containerUser": "root",
    "remoteUser": "root",

    // Keep the container running even if VS Code closes
    "shutdownAction": "stopContainer",

    // Mount the workspace
    "workspaceMount": "source=${localWorkspaceFolder},target=/workspaces/${localWorkspaceFolderBasename},type=bind",
    "workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}",

    // VS Code extensions (kept from original + ROS additions)
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python",
                "donjayamanne.python-environment-manager",
                "github.copilot",
                "github.copilot-chat",
                "github.vscode-pull-request-github",
                "guyutongxue.cpp-reference",
                "ms-python.debugpy",
                "ms-python.vscode-pylance",
                "ms-python.vscode-python-envs",
                "ms-toolsai.datawrangler",
                "ms-toolsai.jupyter",
                "ms-toolsai.jupyter-keymap",
                "ms-toolsai.jupyter-renderers",
                "ms-toolsai.vscode-jupyter-cell-tags",
                "ms-toolsai.vscode-jupyter-slideshow",
                "ms-vscode.cmake-tools",
                "ms-vscode.cpptools",
                "ms-vscode.cpptools-extension-pack",
                "ms-vscode.cpptools-themes",
                "ms-vscode.powershell",
                "ms-vscode.remote-explorer",
                "ms-vscode-remote.remote-containers",
                "ms-vscode.remote-server",
                "shd101wyy.markdown-preview-enhanced",
                "tomoki1207.pdf",
                "twxs.cmake",
                "yzane.markdown-pdf",
                "ms-iot.vscode-ros",
                "redhat.vscode-yaml",
                "streetsidesoftware.code-spell-checker"
            ],
            "settings": {
                "python.defaultInterpreterPath": "/isaac-sim/python.sh",
                "terminal.integrated.defaultProfile.linux": "bash"
            }
        }
    },

    // Post-create setup script
    "postCreateCommand": "bash /workspaces/${localWorkspaceFolderBasename}/.devcontainer/setup.sh"
}